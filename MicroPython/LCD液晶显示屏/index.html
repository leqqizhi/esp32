<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="胡长国" /><link rel="canonical" href="https://shop143975681.taobao.com/MicroPython/LCD%E6%B6%B2%E6%99%B6%E6%98%BE%E7%A4%BA%E5%B1%8F/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>16.LCD液晶显示屏 - 小小工程师技术文档</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "16.LCD\u6db2\u6676\u663e\u793a\u5c4f";
        var mkdocs_page_input_path = "MicroPython\\LCD\u6db2\u6676\u663e\u793a\u5c4f.md";
        var mkdocs_page_url = "/MicroPython/LCD%E6%B6%B2%E6%99%B6%E6%98%BE%E7%A4%BA%E5%B1%8F/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../img/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">ESP32单片机</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Mixly可视化编程</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Mixly/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">1.环境搭建</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Mixly/installation.md">2.点亮LED灯</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Mixly/installation.md">3.流水灯</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Mixly/installation.md">4.数码管显示</a>
                </li>
                <li class="toctree-l2"><a class="" href="../../Mixly/installation.md">5.四位数码管显示</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >MicroPython文本编程</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">1.环境搭建</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%82%B9%E4%BA%AELED%E7%81%AF/">2.点亮LED灯</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B5%81%E6%B0%B4%E7%81%AF/">3.流水灯</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E4%BA%A4%E9%80%9A%E4%BF%A1%E5%8F%B7%E7%81%AF/">4.交通信号灯</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../PWM%E5%91%BC%E5%90%B8%E7%81%AF/">5.PWM呼吸灯</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../RGB%20LED%E7%81%AF/">6.RGB LED灯</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../RGB%20LED%E7%81%AF%E6%9D%A1/">7.RGB LED灯条</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA/">8.直流电机</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E8%88%B5%E6%9C%BA/">9.舵机</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/">10.步进电机</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%8C%89%E9%94%AE%E6%A8%A1%E5%9D%97/">11.按键模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%AD%E6%96%AD/">12.定时器中断</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E4%B8%80%E4%BD%8D%E6%95%B0%E7%A0%81%E7%AE%A1/">13.一位数码管</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%9B%9B%E4%BD%8D%E6%95%B0%E7%A0%81%E7%AE%A1/">14.四位数码管</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%9B%9B%E4%BD%8D%E6%97%B6%E9%92%9F%E6%95%B0%E7%A0%81%E7%AE%A1/">15.四位时钟数码管</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">16.LCD液晶显示屏</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#_1">准备工作</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#lcd_1">实验一：LCD液晶屏的显示</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#lcd_2">实验二：LCD液晶屏显示日期时间</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#lcd_3">实验三：LCD液晶屏显示日期（中断的方式）</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../OLED%E6%98%BE%E7%A4%BA%E5%B1%8F/">17.OLED显示屏</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../8%C3%978%E7%82%B9%E9%98%B5%E5%B1%8F/">18.8×8点阵屏</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ADC%E6%95%B0%E6%A8%A1%E8%BD%AC%E6%8D%A2%E5%99%A8/">19.ADC数模转换器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%91%87%E6%9D%86%E6%8E%A7%E5%88%B6%E7%82%B9%E9%98%B5%E5%B1%8F%E4%B8%8A%E7%82%B9/">20.摇杆控制点阵屏上点</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E8%9C%82%E9%B8%A3%E5%99%A8%E6%A8%A1%E5%9D%97/">21.蜂鸣器模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%A3%B0%E9%9F%B3%E4%BC%A0%E6%84%9F%E5%99%A8/">22.声音传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%8E%AF%E5%A2%83%E5%85%89%E7%BA%BF%E4%BC%A0%E6%84%9F%E5%99%A8/">23.环境光线传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%83%AD%E6%95%8F%E4%BC%A0%E6%84%9F%E5%99%A8/">24.热敏传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%81%AB%E7%84%B0%E4%BC%A0%E6%84%9F%E5%99%A8/">25.火焰传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B0%94%E4%BD%93%E4%BC%A0%E6%84%9F%E5%99%A8/">26.气体传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E8%A7%A6%E6%91%B8%E4%BC%A0%E6%84%9F%E5%99%A8/">27.触摸传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E4%BA%BA%E4%BD%93%E6%84%9F%E5%BA%94%E4%BC%A0%E6%84%9F%E5%99%A8/">28.人体感应传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E9%9C%8D%E5%B0%94%E4%BC%A0%E6%84%9F%E5%99%A8/">29.霍尔传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%80%BE%E6%96%9C%E4%BC%A0%E6%84%9F%E5%99%A8/">30.倾斜传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E9%9C%87%E5%8A%A8%E4%BC%A0%E6%84%9F%E5%99%A8/">31.震动传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B0%B4%E8%92%B8%E6%B0%94%E4%BC%A0%E6%84%9F%E5%99%A8/">32.水蒸气传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E9%9B%A8%E6%BB%B4%E4%BC%A0%E6%84%9F%E5%99%A8/">33.雨滴传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B0%B4%E6%B7%B1%E4%BC%A0%E6%84%9F%E5%99%A8/">34.水深传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%9C%9F%E5%A3%A4%E6%B9%BF%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/">35.土壤湿度传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%BF%80%E5%85%89%E9%98%B2%E7%9B%97/">36.激光防盗</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%BA%A2%E5%A4%96%E9%81%BF%E9%9A%9C%E4%BC%A0%E6%84%9F%E5%99%A8/">37.红外避震传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%A7%BD%E5%9E%8B%E5%85%89%E7%94%B5%E4%BC%A0%E6%84%9F%E5%99%A8/">38.槽型光电传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E8%B6%85%E5%A3%B0%E6%B3%A2%E4%BC%A0%E6%84%9F%E5%99%A8/">39.超声波传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%95%B0%E5%AD%97%E6%B8%A9%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/">40.数字温度度传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B8%A9%E6%B9%BF%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/">41.温湿度传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%81%B0%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/">42.灰度传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%97%8B%E9%92%AE%E7%BC%96%E7%A0%81%E5%99%A8/">43.旋钮编码器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%B0%B4%E9%9B%BE%E5%8C%96%E6%A8%A1%E5%9D%97/">44.水雾化模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%A2%B0%E6%92%9E%E4%BC%A0%E6%84%9F%E5%99%A8/">45.碰撞传感器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E6%BB%91%E5%8A%A8%E7%94%B5%E4%BD%8D%E5%99%A8/">46.滑动电位器</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E5%AE%9E%E6%97%B6%E6%97%B6%E9%92%9F%E6%A8%A1%E5%9D%97/">47.实时时钟模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E7%BA%A2%E5%A4%96%E9%81%A5%E6%8E%A7%E6%A8%A1%E5%9D%97/">48.红外遥控模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../MPU6050%20%E9%99%80%E8%9E%BA%E4%BB%AA%E6%A8%A1%E5%9D%97/">49.MPU6050 陀螺仪模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../NFC%E6%84%9F%E5%BA%94%E8%AF%BB%E5%86%99%E5%8D%A1%E6%A8%A1%E5%9D%97/">50.NFC感应读写卡模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../TCS342%E9%A2%9C%E8%89%B2%E4%BC%A0%E6%84%9F%E5%99%A8%E6%A8%A1%E5%9D%97/">51.TCS342颜色传感器模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SD%E8%AF%BB%E5%8D%A1%E5%99%A8%E6%A8%A1%E5%9D%97/">52.SD读卡器模块</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../%E8%AF%AD%E9%9F%B3%E6%A8%A1%E5%9D%97/">53.语音模块</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">小小工程师技术文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">ESP32单片机</li>
          <li class="breadcrumb-item">MicroPython文本编程</li>
      <li class="breadcrumb-item active">16.LCD液晶显示屏</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h3 id="lcd">LCD液晶显示屏</h3>
<hr />
<h4 id="_1">准备工作</h4>
<ul>
<li><strong>用到的器材</strong></li>
</ul>
<hr />
<table>
<thead>
<tr>
<th style="text-align: center;">序号</th>
<th style="text-align: center;">名称</th>
<th style="text-align: center;">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">ESP32开发板</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">ESP32拓展版</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">LCD液晶显示屏</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>电路搭建</strong></li>
</ul>
<hr />
<p><img alt="15-1.jpg" src="../../img/15-1.jpg" /></p>
<table>
<thead>
<tr>
<th style="text-align: center;">序号</th>
<th style="text-align: center;">名称</th>
<th style="text-align: center;">引脚号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">四位时钟数码管-SCL</td>
<td style="text-align: center;">22</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">四位时钟数码管-SDA</td>
<td style="text-align: center;">21</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">四位时钟数码管-VCC</td>
<td style="text-align: center;">P2</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">四位时钟数码管-GND</td>
<td style="text-align: center;">P2</td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li><strong>四位时钟数码管介绍</strong></li>
</ul>
<p>LCD1602是一种广泛应用的字符型液晶显示模块，主要用于显示字母、数字和符号等ASCII字符。</p>
<ul>
<li><strong>认识 IIC（I2C）接口</strong></li>
</ul>
<p>由于 1602 的管脚数过多，如果直接与 ESP32 开发板连接需要占用大量的 GPIO 管脚，不但容易造成资源浪费，连接也非常不方便，编程的难度也会比较大。</p>
<p>因此实际使用时往往会给 1602 屏增加一块 IIC 驱动版，将 1602 的 16 个管脚连接到由 PCF8574T 作为主要芯片的驱动版上，将接口转换为 IIC 再连接开发板。</p>
<p>IIC 是一种硬件设备间常用的接口通讯协议，全称是 Inter-Integrated Circuit，也可以写为 I2C。他的设计时的理念是：信号线尽量少并且速率要尽量高。 </p>
<ul>
<li><strong>IIC的类和函数</strong></li>
</ul>
<p>我们常用的是软件IIC总线方式通讯（通过程序来模拟IIC通讯），这样可以随意的使用GPIO引脚，但是效率有所下降，在进行IIC编程时，自己编写程序，难度比较大，还好我们可以直接使用第三方库文件</p>
<p>我们在libs文件夹中新建一个TM1637.py文件用来控制软件IIC，还需要创建一个lcd_api.py文件，这是用来控制硬件IIC，因为软件IIC是对硬件IIC的继承，所以两个文件都要保存在libs文件夹中。</p>
<pre><code class="language-python">'''
软件IIC库（对硬件IIC的继承）
'''
import utime

from libs.lcd_api import LcdApi
from machine import I2C

# PCF8574 pin definitions
MASK_RS = 0x01  # P0
MASK_RW = 0x02  # P1
MASK_E = 0x04  # P2

SHIFT_BACKLIGHT = 3  # P3
SHIFT_DATA = 4  # P4-P7


class I2cLcd(LcdApi):

    # Implements a HD44780 character LCD connected via PCF8574 on I2C

    def __init__(self, i2c, i2c_addr, num_lines, num_columns):
        self.i2c = i2c
        self.i2c_addr = i2c_addr
        self.i2c.writeto(self.i2c_addr, bytes([0]))
        utime.sleep_ms(20)  # Allow LCD time to powerup
        # Send reset 3 times
        self.hal_write_init_nibble(self.LCD_FUNCTION_RESET)
        utime.sleep_ms(5)  # Need to delay at least 4.1 msec
        self.hal_write_init_nibble(self.LCD_FUNCTION_RESET)
        utime.sleep_ms(1)
        self.hal_write_init_nibble(self.LCD_FUNCTION_RESET)
        utime.sleep_ms(1)
        # Put LCD into 4-bit mode
        self.hal_write_init_nibble(self.LCD_FUNCTION)
        utime.sleep_ms(1)
        LcdApi.__init__(self, num_lines, num_columns)
        cmd = self.LCD_FUNCTION
        if num_lines &gt; 1:
            cmd |= self.LCD_FUNCTION_2LINES
        self.hal_write_command(cmd)

    def hal_write_init_nibble(self, nibble):
        # Writes an initialization nibble to the LCD.
        # This particular function is only used during initialization.
        byte = ((nibble &gt;&gt; 4) &amp; 0x0f) &lt;&lt; SHIFT_DATA
        self.i2c.writeto(self.i2c_addr, bytes([byte | MASK_E]))
        self.i2c.writeto(self.i2c_addr, bytes([byte]))

    def hal_backlight_on(self):
        # Allows the hal layer to turn the backlight on
        self.i2c.writeto(self.i2c_addr, bytes([1 &lt;&lt; SHIFT_BACKLIGHT]))

    def hal_backlight_off(self):
        # Allows the hal layer to turn the backlight off
        self.i2c.writeto(self.i2c_addr, bytes([0]))

    def hal_write_command(self, cmd):
        # Write a command to the LCD. Data is latched on the falling edge of E.
        byte = ((self.backlight &lt;&lt; SHIFT_BACKLIGHT) |
                (((cmd &gt;&gt; 4) &amp; 0x0f) &lt;&lt; SHIFT_DATA))
        self.i2c.writeto(self.i2c_addr, bytes([byte | MASK_E]))
        self.i2c.writeto(self.i2c_addr, bytes([byte]))
        byte = ((self.backlight &lt;&lt; SHIFT_BACKLIGHT) |
                ((cmd &amp; 0x0f) &lt;&lt; SHIFT_DATA))
        self.i2c.writeto(self.i2c_addr, bytes([byte | MASK_E]))
        self.i2c.writeto(self.i2c_addr, bytes([byte]))
        if cmd &lt;= 3:
            # The home and clear commands require a worst case delay of 4.1 msec
            utime.sleep_ms(5)

    def hal_write_data(self, data):
        # Write data to the LCD. Data is latched on the falling edge of E.
        byte = (MASK_RS |
                (self.backlight &lt;&lt; SHIFT_BACKLIGHT) |
                (((data &gt;&gt; 4) &amp; 0x0f) &lt;&lt; SHIFT_DATA))
        self.i2c.writeto(self.i2c_addr, bytes([byte | MASK_E]))
        self.i2c.writeto(self.i2c_addr, bytes([byte]))
        byte = (MASK_RS |
                (self.backlight &lt;&lt; SHIFT_BACKLIGHT) |
                ((data &amp; 0x0f) &lt;&lt; SHIFT_DATA))
        self.i2c.writeto(self.i2c_addr, bytes([byte | MASK_E]))
        self.i2c.writeto(self.i2c_addr, bytes([byte]))
</code></pre>
<pre><code class="language-python">'''
硬件IIC库
libs/lcd_api.py
'''
import time

class LcdApi:
    # Implements the API for talking with HD44780 compatible character LCDs.
    # This class only knows what commands to send to the LCD, and not how to get
    # them to the LCD.
    #
    # It is expected that a derived class will implement the hal_xxx functions.
    #
    # The following constant names were lifted from the avrlib lcd.h header file,
    # with bit numbers changed to bit masks.

    # HD44780 LCD controller command set
    LCD_CLR = 0x01  # DB0: clear display
    LCD_HOME = 0x02  # DB1: return to home position

    LCD_ENTRY_MODE = 0x04  # DB2: set entry mode
    LCD_ENTRY_INC = 0x02  # DB1: increment
    LCD_ENTRY_SHIFT = 0x01  # DB0: shift

    LCD_ON_CTRL = 0x08  # DB3: turn lcd/cursor on
    LCD_ON_DISPLAY = 0x04  # DB2: turn display on
    LCD_ON_CURSOR = 0x02  # DB1: turn cursor on
    LCD_ON_BLINK = 0x01  # DB0: blinking cursor

    LCD_MOVE = 0x10  # DB4: move cursor/display
    LCD_MOVE_DISP = 0x08  # DB3: move display (0-&gt; move cursor)
    LCD_MOVE_RIGHT = 0x04  # DB2: move right (0-&gt; left)

    LCD_FUNCTION = 0x20  # DB5: function set
    LCD_FUNCTION_8BIT = 0x10  # DB4: set 8BIT mode (0-&gt;4BIT mode)
    LCD_FUNCTION_2LINES = 0x08  # DB3: two lines (0-&gt;one line)
    LCD_FUNCTION_10DOTS = 0x04  # DB2: 5x10 font (0-&gt;5x7 font)
    LCD_FUNCTION_RESET = 0x30  # See &quot;Initializing by Instruction&quot; section

    LCD_CGRAM = 0x40  # DB6: set CG RAM address
    LCD_DDRAM = 0x80  # DB7: set DD RAM address

    LCD_RS_CMD = 0
    LCD_RS_DATA = 1

    LCD_RW_WRITE = 0
    LCD_RW_READ = 1

    def __init__(self, num_lines, num_columns):
        self.num_lines = num_lines
        if self.num_lines &gt; 4:
            self.num_lines = 4
        self.num_columns = num_columns
        if self.num_columns &gt; 40:
            self.num_columns = 40
        self.cursor_x = 0
        self.cursor_y = 0
        self.implied_newline = False
        self.backlight = True
        self.display_off()
        self.backlight_on()
        self.clear()
        self.hal_write_command(self.LCD_ENTRY_MODE | self.LCD_ENTRY_INC)
        self.hide_cursor()
        self.display_on()

    def clear(self):
        # Clears the LCD display and moves the cursor to the top left corner
        self.hal_write_command(self.LCD_CLR)
        self.hal_write_command(self.LCD_HOME)
        self.cursor_x = 0
        self.cursor_y = 0

    def show_cursor(self):
        # Causes the cursor to be made visible
        self.hal_write_command(self.LCD_ON_CTRL | self.LCD_ON_DISPLAY |
                               self.LCD_ON_CURSOR)

    def hide_cursor(self):
        # Causes the cursor to be hidden
        self.hal_write_command(self.LCD_ON_CTRL | self.LCD_ON_DISPLAY)

    def blink_cursor_on(self):
        # Turns on the cursor, and makes it blink
        self.hal_write_command(self.LCD_ON_CTRL | self.LCD_ON_DISPLAY |
                               self.LCD_ON_CURSOR | self.LCD_ON_BLINK)

    def blink_cursor_off(self):
        # Turns on the cursor, and makes it no blink (i.e. be solid)
        self.hal_write_command(self.LCD_ON_CTRL | self.LCD_ON_DISPLAY |
                               self.LCD_ON_CURSOR)

    def display_on(self):
        # Turns on (i.e. unblanks) the LCD
        self.hal_write_command(self.LCD_ON_CTRL | self.LCD_ON_DISPLAY)

    def display_off(self):
        # Turns off (i.e. blanks) the LCD
        self.hal_write_command(self.LCD_ON_CTRL)

    def backlight_on(self):
        # Turns the backlight on.

        # This isn't really an LCD command, but some modules have backlight
        # controls, so this allows the hal to pass through the command.
        self.backlight = True
        self.hal_backlight_on()

    def backlight_off(self):
        # Turns the backlight off.

        # This isn't really an LCD command, but some modules have backlight
        # controls, so this allows the hal to pass through the command.
        self.backlight = False
        self.hal_backlight_off()

    def move_to(self, cursor_x, cursor_y):
        # Moves the cursor position to the indicated position. The cursor
        # position is zero based (i.e. cursor_x == 0 indicates first column).
        self.cursor_x = cursor_x
        self.cursor_y = cursor_y
        addr = cursor_x &amp; 0x3f
        if cursor_y &amp; 1:
            addr += 0x40  # Lines 1 &amp; 3 add 0x40
        if cursor_y &amp; 2:  # Lines 2 &amp; 3 add number of columns
            addr += self.num_columns
        self.hal_write_command(self.LCD_DDRAM | addr)

    def putchar(self, char):
        # Writes the indicated character to the LCD at the current cursor
        # position, and advances the cursor by one position.
        if char == '\n':
            if self.implied_newline:
                # self.implied_newline means we advanced due to a wraparound,
                # so if we get a newline right after that we ignore it.
                pass
            else:
                self.cursor_x = self.num_columns
        else:
            self.hal_write_data(ord(char))
            self.cursor_x += 1
        if self.cursor_x &gt;= self.num_columns:
            self.cursor_x = 0
            self.cursor_y += 1
            self.implied_newline = (char != '\n')
        if self.cursor_y &gt;= self.num_lines:
            self.cursor_y = 0
        self.move_to(self.cursor_x, self.cursor_y)

    def putstr(self, string):
        # Write the indicated string to the LCD at the current cursor
        # position and advances the cursor position appropriately.
        for char in string:
            self.putchar(char)

    def custom_char(self, location, charmap):
        # Write a character to one of the 8 CGRAM locations, available
        # as chr(0) through chr(7).
        location &amp;= 0x7
        self.hal_write_command(self.LCD_CGRAM | (location &lt;&lt; 3))
        self.hal_sleep_us(40)
        for i in range(8):
            self.hal_write_data(charmap[i])
            self.hal_sleep_us(40)
        self.move_to(self.cursor_x, self.cursor_y)

    def hal_backlight_on(self):
        # Allows the hal layer to turn the backlight on.
        # If desired, a derived HAL class will implement this function.
        pass

    def hal_backlight_off(self):
        # Allows the hal layer to turn the backlight off.
        # If desired, a derived HAL class will implement this function.
        pass

    def hal_write_command(self, cmd):
        # Write a command to the LCD.
        # It is expected that a derived HAL class will implement this function.
        raise NotImplementedError

    def hal_write_data(self, data):
        # Write data to the LCD.
        # It is expected that a derived HAL class will implement this function.
        raise NotImplementedError

    def hal_sleep_us(self, usecs):
        # Sleep for some time (given in microseconds)
        time.sleep_us(usecs)
</code></pre>
<h4 id="lcd_1">实验一：LCD液晶屏的显示</h4>
<hr />
<p><strong>代码如下：</strong></p>
<pre><code class="language-python"># 导入库文件
from machine import Pin, SoftI2C, I2C
from libs.I2cLcd import I2cLcd
import time

# 初始化操作
i2c = SoftI2C(sda=Pin(21), scl=Pin(22), freq=400000)  # 定义 SoftI2C 控制对象
address = i2c.scan()[0]  # 获取 I2C 从机地址
i2c_lcd = I2cLcd(i2c, address, 2, 16) # 定义 I2CLCD 对象

# 清屏操作，防止之前的显示对后面产生影响
i2c_lcd.clear()

# 显示光标2秒后影藏光标2秒
i2c_lcd.show_cursor() # 显示光标2秒
time.sleep(2)
i2c_lcd.hide_cursor() # 影藏光标
time.sleep(2)

# 闪烁光标2秒，blink_cursor_off方法作用光标不闪烁
i2c_lcd.blink_cursor_on()
time.sleep(2)

# 关闭背光2秒后，开启背光
i2c_lcd.backlight_off() # 关闭背光
time.sleep(2)
i2c_lcd.backlight_on()

# 移动光标到指定位置(坐标从左上角(0,0)开始。注意不要越界)
i2c_lcd.move_to(cursor_x=5,cursor_y=1) # 光标在第6列的第二行显示

# 在光标位置写入单个字符，自动下移光标
i2c_lcd.putchar('g') # 只能是单个字符哦
time.sleep(2)

# 在光标位置写入字符串，自动光标下移动
i2c_lcd.putstr(' hello') # 空格即跳过一个空格
time.sleep(2)
</code></pre>
<hr />
<h4 id="lcd_2">实验二：LCD液晶屏显示日期时间</h4>
<hr />
<p><strong>程序如下：</strong></p>
<pre><code class="language-python"># 导入库文件
from machine import Pin, SoftI2C, I2C, RTC
from libs.I2cLcd import I2cLcd
import time

# 初始化操作
i2c = SoftI2C(sda=Pin(21), scl=Pin(22), freq=400000)  # 定义 SoftI2C 控制对象
address = i2c.scan()[0]  # 获取 I2C 从机地址
i2c_lcd = I2cLcd(i2c, address, 2, 16) # 定义 I2CLCD 对象

# 清屏操作，防止之前的显示对后面产生影响
i2c_lcd.clear()

# 创建RTC对象
rtc =RTC()

# 创建星期列表
week= ['Mon','Tue','Wed','Thu','Fri','Sat','Sun']
while True:
    i2c_lcd.clear()
    # 获取实时时间
    datetime = rtc.datetime()
    # 写入时间数据
    i2c_lcd.putstr('%d-%02d-%02d  %s\n' % (datetime[0],datetime[1],datetime[2],week[datetime[3]]))
    i2c_lcd.putstr('%02d:%02d:%02d' % (datetime[4],datetime[5],datetime[6]))
    # 显示时间1秒后刷新数据
    time.sleep(1)
</code></pre>
<hr />
<h4 id="lcd_3">实验三：LCD液晶屏显示日期（中断的方式）</h4>
<hr />
<p><strong>程序如下</strong></p>
<pre><code class="language-python"># 导入库文件
from machine import Pin, SoftI2C, I2C, RTC, Timer
from libs.I2cLcd import I2cLcd
import time

# 初始化操作
i2c = SoftI2C(sda=Pin(21), scl=Pin(22), freq=400000)  # 定义 SoftI2C 控制对象
address = i2c.scan()[0]  # 获取 I2C 从机地址
i2c_lcd = I2cLcd(i2c, address, 2, 16) # 定义 I2CLCD 对象

# 清屏操作，防止之前的显示对后面产生影响
i2c_lcd.clear()

# 创建RTC对象
rtc =RTC()

# 创建星期列表
week= ['Mon','Tue','Wed','Thu','Fri','Sat','Sun']

# 定义定时器中断函数
def timer_irq(timer_obj):
    i2c_lcd.clear()
    # 获取实时时间
    datetime = rtc.datetime()
    # 写入时间数据
    i2c_lcd.putstr('%d-%02d-%02d  %s\n' % (datetime[0],datetime[1],datetime[2],week[datetime[3]]))
    i2c_lcd.putstr('%02d:%02d:%02d' % (datetime[4],datetime[5],datetime[6]))

# 初始化定时器对象
timer = Timer(0)
timer.init(period=1000, mode=Timer.PERIODIC, callback=timer_irq)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../%E5%9B%9B%E4%BD%8D%E6%97%B6%E9%92%9F%E6%95%B0%E7%A0%81%E7%AE%A1/" class="btn btn-neutral float-left" title="15.四位时钟数码管"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../OLED%E6%98%BE%E7%A4%BA%E5%B1%8F/" class="btn btn-neutral float-right" title="17.OLED显示屏">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2025 乐启智玩具有限公司</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../%E5%9B%9B%E4%BD%8D%E6%97%B6%E9%92%9F%E6%95%B0%E7%A0%81%E7%AE%A1/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../OLED%E6%98%BE%E7%A4%BA%E5%B1%8F/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
